<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Zona;
use App\Models\ZonaHorario;
use Illuminate\Support\Facades\DB;

class ZonaSeeder extends Seeder
{
    public function run(): void
    {
        DB::statement('SET FOREIGN_KEY_CHECKS=0;');
        Zona::truncate();
        ZonaHorario::truncate();
        DB::statement('SET FOREIGN_KEY_CHECKS=1;');

        $zonasData = [
            // ZONA ROSA - Lunes a viernes de 7 a 14 Hs.
            [
                'zona' => [
                    'nombre' => 'Zona Rosa',
                    'descripcion' => 'Zona de estacionamiento tarifado rosa - Lunes a viernes de 7 a 14 Hs.',
                    'color_mapa' => '#d9277c',
                    'poligono_coordenadas' => [
                        // Polígono 1 (único polígono para zona rosa)
                        [
                            ['lat' => -34.91138161737739, 'lng' => -57.955797513131316],
                            ['lat' => -34.9114313281376, 'lng' => -57.955908747174604],
                            ['lat' => -34.91354780449554, 'lng' => -57.95823858580795],
                            ['lat' => -34.915887333625044, 'lng' => -57.96078947495732],
                            ['lat' => -34.915756078821275, 'lng' => -57.96098364124241],
                            ['lat' => -34.91575472547897, 'lng' => -57.96203893145817],
                            ['lat' => -34.91587812692757, 'lng' => -57.96217197983114],
                            ['lat' => -34.916672814557074, 'lng' => -57.962128903625256],
                            ['lat' => -34.91677126732027, 'lng' => -57.96210457177874],
                            ['lat' => -34.91807548802964, 'lng' => -57.963542307261264],
                            ['lat' => -34.92146122166057, 'lng' => -57.95903221279805],
                            ['lat' => -34.92149588133257, 'lng' => -57.95899319117839],
                            ['lat' => -34.921425840306256, 'lng' => -57.957166896338336],
                            ['lat' => -34.9213399980213, 'lng' => -57.956945586032575],
                            ['lat' => -34.919473537326766, 'lng' => -57.954897878955535],
                            ['lat' => -34.91823569034611, 'lng' => -57.954992063335],
                            ['lat' => -34.91422432108261, 'lng' => -57.955241596833204],
                            ['lat' => -34.91169116589093, 'lng' => -57.95539408175446],
                            ['lat' => -34.91138161737739, 'lng' => -57.955797513131316]
                        ]
                    ],
                    'es_prohibido_estacionar' => false,
                    'activa' => true
                ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '07:00:00', 'hora_fin' => '14:00:00'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '07:00:00', 'hora_fin' => '14:00:00'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '07:00:00', 'hora_fin' => '14:00:00'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '07:00:00', 'hora_fin' => '14:00:00'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '07:00:00', 'hora_fin' => '14:00:00']
                ]
            ],

            // ZONA AZUL - Lunes a sábados de 9 a 20 Hs.
            [
                'zona' => [
                    'nombre' => 'Zona Azul',
                    'descripcion' => 'Zona de estacionamiento tarifado azul - Lunes a sábados de 9 a 20 Hs.',
                    'color_mapa' => '#009cd3',
                    'poligono_coordenadas' => [
                        // Polígono 1 (único polígono para zona azul)
                        [
                            ['lat' => -34.92226772154417, 'lng' => -57.95321955053939],
                            ['lat' => -34.92236576587318, 'lng' => -57.95313095932245],
                            ['lat' => -34.92348634273881, 'lng' => -57.95162918248454],
                            ['lat' => -34.924899114562564, 'lng' => -57.94975128620223],
                            ['lat' => -34.92597358583373, 'lng' => -57.948305899181236],
                            ['lat' => -34.925920119748405, 'lng' => -57.94726380085818],
                            ['lat' => -34.926037445895595, 'lng' => -57.94709631683254],
                            ['lat' => -34.926905200009124, 'lng' => -57.94703893944801],
                            ['lat' => -34.92737020181398, 'lng' => -57.94641309414693],
                            ['lat' => -34.92980451984275, 'lng' => -57.94312647488559],
                            ['lat' => -34.92887353096391, 'lng' => -57.942136664684],
                            ['lat' => -34.92886146625871, 'lng' => -57.94215406756673],
                            ['lat' => -34.92733415745105, 'lng' => -57.94207900779554],
                            ['lat' => -34.92661165728644, 'lng' => -57.94306285698559],
                            ['lat' => -34.92624007802496, 'lng' => -57.943545348672345],
                            ['lat' => -34.9254248815846, 'lng' => -57.9446470767661],
                            ['lat' => -34.92280393136689, 'lng' => -57.94818510275188],
                            ['lat' => -34.92135088605425, 'lng' => -57.95016911174275],
                            ['lat' => -34.92142676714613, 'lng' => -57.95220309937605],
                            ['lat' => -34.921666211859325, 'lng' => -57.95247326838806],
                            ['lat' => -34.92175955324719, 'lng' => -57.95264509220351],
                            ['lat' => -34.92226772154417, 'lng' => -57.95321955053939]
                        ]
                    ],
                    'es_prohibido_estacionar' => false,
                    'activa' => true
                ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'sabado', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00']
                ]
            ],

            // ZONA VERDE - Lunes a viernes de 7 a 20 Hs. Sábados de 9 a 20 Hs. (3 polígonos)
            [
                'zona' => [
                    'nombre' => 'Zona Verde',
                    'descripcion' => 'Zona libre de estacionamiento - Lunes a viernes de 7 a 20 Hs. Sábados de 9 a 20 Hs.',
                    'color_mapa' => '#60a43b',
                    'poligono_coordenadas' => [
                        // Polígono 1
                        [
                            ['lat' => -34.91148933193238, 'lng' => -57.95505709418876],
                            ['lat' => -34.911492525349395, 'lng' => -57.9554193747861],
                            ['lat' => -34.911613849383386, 'lng' => -57.95536931372432],
                            ['lat' => -34.91175976674565, 'lng' => -57.95535124122095],
                            ['lat' => -34.913883389017016, 'lng' => -57.95521402303763],
                            ['lat' => -34.9182082832751, 'lng' => -57.954965947739524],
                            ['lat' => -34.919462148000086, 'lng' => -57.95482509121378],
                            ['lat' => -34.91949710358251, 'lng' => -57.95476899557052],
                            ['lat' => -34.91956733552755, 'lng' => -57.954656713532444],
                            ['lat' => -34.920059320457, 'lng' => -57.9540908347162],
                            ['lat' => -34.91892466251488, 'lng' => -57.95283321036102],
                            ['lat' => -34.91669421017178, 'lng' => -57.95037798330192],
                            ['lat' => -34.91636262033622, 'lng' => -57.9500535760488],
                            ['lat' => -34.91434290231717, 'lng' => -57.95283173520265],
                            ['lat' => -34.91407755931155, 'lng' => -57.953212948848275],
                            ['lat' => -34.9140337696463, 'lng' => -57.953161543193914],
                            ['lat' => -34.91401220586645, 'lng' => -57.95319606675531],
                            ['lat' => -34.913981082579056, 'lng' => -57.95316048891165],
                            ['lat' => -34.914005463079846, 'lng' => -57.95313037703593],
                            ['lat' => -34.91632611682239, 'lng' => -57.95002003899076],
                            ['lat' => -34.91543232125011, 'lng' => -57.949042391893016],
                            ['lat' => -34.91383878790947, 'lng' => -57.95118961071215],
                            ['lat' => -34.912403296360154, 'lng' => -57.953118039988766],
                            ['lat' => -34.91140338902495, 'lng' => -57.95447967390271],
                            ['lat' => -34.91133636692474, 'lng' => -57.95461299696794],
                            ['lat' => -34.911340359206406, 'lng' => -57.954697551884905],
                            ['lat' => -34.911419097019284, 'lng' => -57.95485318763218],
                            ['lat' => -34.9114720363828, 'lng' => -57.95498355750128],
                            ['lat' => -34.91148933193238, 'lng' => -57.95505709418876]
                        ],
                        // Polígono 2
                        [
                            ['lat' => -34.9147800616862, 'lng' => -57.94963402750864],
                            ['lat' => -34.91386486199968, 'lng' => -57.94861956147963],
                            ['lat' => -34.91442439978942, 'lng' => -57.94789048404816],
                            ['lat' => -34.91256115556489, 'lng' => -57.945864899226635],
                            ['lat' => -34.910454204941736, 'lng' => -57.948670286974135],
                            ['lat' => -34.90915393541656, 'lng' => -57.94874356346145],
                            ['lat' => -34.90685765900368, 'lng' => -57.948881958140916],
                            ['lat' => -34.90700772229511, 'lng' => -57.94907628703763],
                            ['lat' => -34.909949478884926, 'lng' => -57.94894620637861],
                            ['lat' => -34.91067206153453, 'lng' => -57.95432926004884],
                            ['lat' => -34.910878629214196, 'lng' => -57.95432584870109],
                            ['lat' => -34.91112615572147, 'lng' => -57.95442394966291],
                            ['lat' => -34.91123405992071, 'lng' => -57.95441817125635],
                            ['lat' => -34.91153394117344, 'lng' => -57.95402913302469],
                            ['lat' => -34.91260999333187, 'lng' => -57.95253778467257],
                            ['lat' => -34.91407781484948, 'lng' => -57.950571032758646],
                            ['lat' => -34.9147800616862, 'lng' => -57.94963402750864]
                        ],
                        // Polígono 3
                        [
                            ['lat' => -34.916712083708575, 'lng' => -57.9470175369748],
                            ['lat' => -34.916847392820664, 'lng' => -57.947159850437615],
                            ['lat' => -34.920377840506276, 'lng' => -57.94243982155976],
                            ['lat' => -34.92021642989064, 'lng' => -57.9422400167566],
                            ['lat' => -34.91880683957862, 'lng' => -57.94420117989955],
                            ['lat' => -34.916712083708575, 'lng' => -57.9470175369748]
                        ]
                    ],
                    'es_prohibido_estacionar' => false,
                    'activa' => true
                ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'sabado', 'hora_inicio' => '09:00:00', 'hora_fin' => '20:00:00']
                ]
            ],

            // ZONA AMARILLA - Lunes a viernes de 7 a 20 Hs. (2 polígonos)
            [
                'zona' => [
                    'nombre' => 'Zona Amarilla',
                    'descripcion' => 'Zona de estacionamiento tarifado amarilla - Lunes a viernes de 7 a 20 Hs.',
                    'color_mapa' => '#eaaa07',
                    'poligono_coordenadas' => [
                        // Polígono 1
                        [
                            ['lat' => -34.91256043575511, 'lng' => -57.94584250459518],
                            ['lat' => -34.91355958407721, 'lng' => -57.94690353909111],
                            ['lat' => -34.914437279420916, 'lng' => -57.94788108634775],
                            ['lat' => -34.91411253382276, 'lng' => -57.94829983042219],
                            ['lat' => -34.91386867467958, 'lng' => -57.94862059480546],
                            ['lat' => -34.914040872549336, 'lng' => -57.948811253690124],
                            ['lat' => -34.91478415392615, 'lng' => -57.9496305578014],
                            ['lat' => -34.914805533942726, 'lng' => -57.94959705881145],
                            ['lat' => -34.91485037858578, 'lng' => -57.94964827666797],
                            ['lat' => -34.91552097682115, 'lng' => -57.94873523790221],
                            ['lat' => -34.916754301152935, 'lng' => -57.94707479695829],
                            ['lat' => -34.91667698888198, 'lng' => -57.94699371046599],
                            ['lat' => -34.915799146390974, 'lng' => -57.946090828597576],
                            ['lat' => -34.91574479151206, 'lng' => -57.946091795400235],
                            ['lat' => -34.91562695177038, 'lng' => -57.946225416578244],
                            ['lat' => -34.91561394220439, 'lng' => -57.94595799561033],
                            ['lat' => -34.91394718213543, 'lng' => -57.9441061556016],
                            ['lat' => -34.91390550385356, 'lng' => -57.94406270332571],
                            ['lat' => -34.91256043575511, 'lng' => -57.94584250459518]
                        ],
                        // Polígono 2
                        [
                            ['lat' => -34.9168482572032, 'lng' => -57.947153585959256],
                            ['lat' => -34.91548535357049, 'lng' => -57.94901265991639],
                            ['lat' => -34.91636850923586, 'lng' => -57.95004781462221],
                            ['lat' => -34.920064559796515, 'lng' => -57.954089580962105],
                            ['lat' => -34.91972866848966, 'lng' => -57.954493937368994],
                            ['lat' => -34.91973299780753, 'lng' => -57.95486382078917],
                            ['lat' => -34.91982621957483, 'lng' => -57.95520259966028],
                            ['lat' => -34.92116838855948, 'lng' => -57.95667504027111],
                            ['lat' => -34.92125761955964, 'lng' => -57.95670804925075],
                            ['lat' => -34.922309214334604, 'lng' => -57.955211490863036],
                            ['lat' => -34.92294518292224, 'lng' => -57.95447254118881],
                            ['lat' => -34.92298431188235, 'lng' => -57.95425221962478],
                            ['lat' => -34.922966698853294, 'lng' => -57.954067870781074],
                            ['lat' => -34.92288215551893, 'lng' => -57.95388701248616],
                            ['lat' => -34.92226454803314, 'lng' => -57.95322072649762],
                            ['lat' => -34.92176141808117, 'lng' => -57.952653544480796],
                            ['lat' => -34.921661572678424, 'lng' => -57.952480360790844],
                            ['lat' => -34.92145106871368, 'lng' => -57.95223835599265],
                            ['lat' => -34.91908250949418, 'lng' => -57.94961398114502],
                            ['lat' => -34.9168482572032, 'lng' => -57.947153585959256]
                        ]
                    ],
                    'es_prohibido_estacionar' => false,
                    'activa' => true
                ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00']
                ]
            ],

            // ZONA PROHIBIDA - Prohibido estacionar (2 polígonos)
            [
                'zona' => [
                    'nombre' => 'Zona Prohibida',
                    'descripcion' => 'Zona de prohibición de estacionamiento',
                    'color_mapa' => '#000000',
                    'poligono_coordenadas' => [
                        // Polígono 1
                        [
                            ['lat' => -34.91635842076749, 'lng' => -57.950054120045095],
                            ['lat' => -34.916334611414975, 'lng' => -57.95002653184865],
                            ['lat' => -34.91494449568269, 'lng' => -57.95187139609831],
                            ['lat' => -34.913984684132686, 'lng' => -57.95316039078118],
                            ['lat' => -34.914010166612805, 'lng' => -57.95318920859454],
                            ['lat' => -34.915330084626156, 'lng' => -57.9514333417401],
                            ['lat' => -34.91635842076749, 'lng' => -57.950054120045095]
                        ],
                        // Polígono 2
                        [
                            ['lat' => -34.91131110137397, 'lng' => -57.95465924979415],
                            ['lat' => -34.911372366985425, 'lng' => -57.9545139307847],
                            ['lat' => -34.91225269204033, 'lng' => -57.95331380682937],
                            ['lat' => -34.91635379373597, 'lng' => -57.9478008421038],
                            ['lat' => -34.91682428125588, 'lng' => -57.94715977221115],
                            ['lat' => -34.91675646762306, 'lng' => -57.94707970476439],
                            ['lat' => -34.91657831387474, 'lng' => -57.9473150794709],
                            ['lat' => -34.914851214215325, 'lng' => -57.94965366730513],
                            ['lat' => -34.91480510607432, 'lng' => -57.949603516893134],
                            ['lat' => -34.91220051821407, 'lng' => -57.95310280460279],
                            ['lat' => -34.9115112085021, 'lng' => -57.95406624294084],
                            ['lat' => -34.91129795402805, 'lng' => -57.95436625566131],
                            ['lat' => -34.9112575244713, 'lng' => -57.954411003255956],
                            ['lat' => -34.91120444165602, 'lng' => -57.95444216359613],
                            ['lat' => -34.91114977626584, 'lng' => -57.95445910516298],
                            ['lat' => -34.911158043543054, 'lng' => -57.95450839538785],
                            ['lat' => -34.91120554187011, 'lng' => -57.95454272558213],
                            ['lat' => -34.91122835800733, 'lng' => -57.95456394167252],
                            ['lat' => -34.91127560549054, 'lng' => -57.95462065814071],
                            ['lat' => -34.91129306847153, 'lng' => -57.95464641877446],
                            ['lat' => -34.91131110137397, 'lng' => -57.95465924979415]
                        ]
                    ],
                    'es_prohibido_estacionar' => true,
                    'activa' => true
                ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59'],
                    ['dia_semana' => 'sabado', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59'],
                    ['dia_semana' => 'domingo', 'hora_inicio' => '00:00:00', 'hora_fin' => '23:59:59']
                ]
            ],

            // ZONA DE PRUEBA - Para testing de la aplicación
            [
                'zona' => [
                    'nombre' => 'Zona de Prueba',
                    'descripcion' => 'Zona de prueba para desarrollo y testing - Disponible 24/7',
                    'color_mapa' => '#ff6b35',
                    'poligono_coordenadas' => [
                        // Polígono actualizado con las nuevas coordenadas
                        [
                            ['lat' => -34.889592732606864, 'lng' => -58.01924667103398],
                            ['lat' => -34.8922776617411, 'lng' => -58.021433626040206],
                            ['lat' => -34.89470532147908, 'lng' => -58.01804721418459],
                            ['lat' => -34.8909618432272, 'lng' => -58.01382388242274],
                            ['lat' => -34.889592732606864, 'lng' => -58.01924667103398]
                        ]
                    ],
                    'es_prohibido_estacionar' => false,
                    'activa' => true
                ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '07:00:00', 'hora_fin' => '20:00:00'],
                    ['dia_semana' => 'sabado', 'hora_inicio' => '09:00:00', 'hora_fin' => '14:00:00']
                ]
            ],

            // ZONA DE PRUEBA 2 - Para testing adicional de la aplicación
            [
                'zona' => [
                    'nombre' => 'Zona de Prueba 2',
                    'descripcion' => 'Segunda zona de prueba para desarrollo y testing - Zona paga de lunes a viernes',
                    'color_mapa' => '#8a2be2', // Color violeta
                    'poligono_coordenadas' => [
                        // Polígono con las nuevas coordenadas (convertidas de lng,lat a lat,lng)
                        [
                            ['lat' => -34.912141610626094, 'lng' => -57.96710502610871],
                            ['lat' => -34.91495896942417, 'lng' => -57.970122705486204],
                            ['lat' => -34.917508258028086, 'lng' => -57.96680200435807],
                            ['lat' => -34.914533243935544, 'lng' => -57.963526810754814],
                            ['lat' => -34.912141610626094, 'lng' => -57.96710502610871]
                        ]
                    ],
                    'es_prohibido_estacionar' => false,
                    'activa' => true
                
            ],
                'horarios' => [
                    ['dia_semana' => 'lunes', 'hora_inicio' => '08:00:00', 'hora_fin' => '11:40:00'],
                    ['dia_semana' => 'martes', 'hora_inicio' => '08:00:00', 'hora_fin' => '11:40:00'],
                    ['dia_semana' => 'miercoles', 'hora_inicio' => '08:00:00', 'hora_fin' => '11:40:00'],
                    ['dia_semana' => 'jueves', 'hora_inicio' => '08:00:00', 'hora_fin' => '11:40:00'],
                    ['dia_semana' => 'viernes', 'hora_inicio' => '08:00:00', 'hora_fin' => '11:40:00']
                ]
            ]
        ];

        foreach ($zonasData as $zonaDatos) {
            $zona = Zona::create($zonaDatos['zona']);
            
            foreach ($zonaDatos['horarios'] as $horario) {
                ZonaHorario::create([
                    'zona_id' => $zona->id,
                    'dia_semana' => $horario['dia_semana'],
                    'hora_inicio' => $horario['hora_inicio'],
                    'hora_fin' => $horario['hora_fin'],
                    'activo' => true
                ]);
            }
        }

        $this->command->info('Se han creado ' . count($zonasData) . ' zonas con múltiples polígonos exitosamente.');
    }
}
